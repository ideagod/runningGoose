webpackJsonp([17],{eg52:function(e,t){},tn9i:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mtWM"),n=s.n(a),i=s("6T4k"),c={data:function(){return{activeName:"",userMessage:[],loading:null}},mounted:function(){this.getMessage()},methods:{getMessage:function(){var e=this,t=this.$loading({lock:!0,text:"玩命加载中..."});n.a.get("/users/userMessage").then(function(s){var a=s.data;if(t.close(),"0"==a.status){e.userMessage=a.result;var n=e.userMessage.filter(function(e){return!e.isRead});n.length||e.$store.commit("saveUserInfo",{msgLen:n.length})}else e.$message({type:"error",message:a.msg})}).catch(function(e){console.log(e)})},handleReadMsg:function(e){var t=this,s=this.userMessage.filter(function(t){return!t.isRead&&t.title==e});""!=e&&s.length&&n.a.get("/users/readMessage?title="+e).then(function(e){var s=e.data;"0"==s.status?(t.getMessage(),i.a.$emit("readMessage")):console.log(s.msg)}).catch(function(e){console.log(e)})},handleDeleteMessage:function(e){var t=this;this.$confirm("此操作将永久删除该消息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){n.a.get("/users/deleteMessage?title="+e).then(function(e){var s=e.data;"0"==s.status?(t.$message({type:"success",message:"删除成功!"}),t.getMessage()):t.$message({type:"error",message:s.msg})}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"myMessage"},[s("person-title",[e._v("我的消息 >> "),s("em",[e._v("消息")])]),e._v(" "),s("div",{staticClass:"myMessage-cont"},[s("el-collapse",{attrs:{accordion:""},on:{change:e.handleReadMsg},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.userMessage,function(t){return s("el-collapse-item",{key:t.title,class:{messageIsRead:t.isRead},attrs:{title:t.title,name:t.title}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-message"}),e._v("\n                "+e._s(t.title)+"\n                ( "+e._s(t.isRead?"已读":"未读")+" )\n                ")]),e._v(" "),s("p",{staticClass:"msg-body"},[e._v("\n                    "+e._s(t.cont)+" "),s("br"),e._v(" "),s("span",[e._v("(发送时间 : "+e._s(t.sendTime)+")")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(s){e.handleDeleteMessage(t.title)}}})],1)],2)}))],1)],1)},staticRenderFns:[]};var o=s("VU/8")(c,l,!1,function(e){s("eg52")},null,null);t.default=o.exports}});