webpackJsonp([15],{RspO:function(e,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=o("mtWM"),s=o.n(t),a=o("6T4k"),n={data:function(){var e=this;return{goodsTpyeList:["生活用品","衣物","食物","数码3c","小家具","电器","箱包","乐器","其他"],goodsSizeList:["较小","小","一般","大","较大","非常大"],companyList:["顺丰","韵达","圆通","中通","申通","邮政","天天","安能","优速","京东","其他"],orderForm:{goodsTpye:"",goodsSize:"",company:[],goodsCode:[],Price:0,goodsNumber:0,remarks:""},rules:{goodsTpye:[{required:!0,message:"请选择物品类型",trigger:"change"}],goodsSize:[{required:!0,message:"请选择快递大小",trigger:"change"}],company:[{required:!0,message:"请选择快递公司",trigger:"change"}],goodsCode:[{required:!0,message:"请输入快递取货码",trigger:"change"},{validator:function(r,o,t){if(o){if(o.length!=e.orderForm.company.length)return void t(new Error("取货码和快递公司数量不匹配 !"));for(var s=0;s<o.length;s++)/^[0-9]{6}$/.test(o[s])||t(new Error("取货码为6位数字 !"));t()}else t()},trigger:"change"}],Price:[{required:!0,type:"number",message:"请设置发布价格",trigger:"blur"}],goodsNumber:[{required:!0,message:"请选择快递数量",trigger:"blur"},{validator:function(r,o,t){o!=e.$data.orderForm.goodsCode.length?t(new Error("取货码数量和快递数量不匹配 !")):t()},message:"取货码数量和快递数量不匹配 !",trigger:"change"}]}}},created:function(){this.handleIsCompInfo()},methods:{handleIsCompInfo:function(){var e=this,r=this.$loading({lock:!0,text:"玩命加载中..."});s.a.get("/users/userInformation").then(function(o){var t=o.data;if(r.close(),"0"==t.status){var s=t.result;s.userName&&s.address||(e.$message({message:"请先完善个人信息,便于联系您",type:"error",showClose:!0}),a.a.$emit("goNewOrder","addInformation",1),e.$router.push({path:"addInformation"}))}else console.log(t.msg)}).catch(function(e){console.log(e)})},handleNewOrder:function(e){var r=this,o=this.$loading({lock:!0,text:"正在发布..."});s.a.post("/users/newOrder",e).then(function(e){var t=e.data;o.close(),"0"==t.status?(r.$message({message:"恭喜你，发布成功!",type:"success"}),a.a.$emit("goNewOrder","currentOrder"),r.$router.push({path:"currentOrder"})):r.$message({message:t.msg,type:"error"})}).catch(function(e){console.log(e)})},submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;r.$confirm("确认填写正确, 是否支付 "+r.orderForm.Price+" 元并发布订单?","发布订单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){var e={goodsTpye:r.orderForm.goodsTpye,goodsSize:r.orderForm.goodsSize,company:r.orderForm.company,goodsCode:r.orderForm.goodsCode,Price:r.orderForm.Price,goodsNumber:r.orderForm.goodsNumber,remarks:r.orderForm.remarks},o=r.$loading({lock:!0,text:"正在支付..."});setTimeout(function(){o.close(),r.$message({message:"支付成功!",type:"success"}),r.handleNewOrder(e)},600)}).catch(function(){r.$message({type:"info",message:"已取消发布"})})})},resetForm:function(e){this.$refs[e].resetFields()}}},l={render:function(){var e=this,r=e.$createElement,o=e._self._c||r;return o("div",{staticClass:"newOrder"},[o("person-title",[e._v("当前位置 :: 我的订单 >> "),o("em",[e._v("发布订单")])]),e._v(" "),o("div",{staticClass:"createNewOrder"},[o("el-form",{ref:"newOrder",staticClass:"demo-orderForm",attrs:{model:e.orderForm,rules:e.rules,"label-position":"left","status-icon":!0,"label-width":"7rem"},nativeOn:{submit:function(e){e.preventDefault()}}},[o("el-form-item",{attrs:{label:"物品类型 : ",prop:"goodsTpye"}},[o("el-select",{attrs:{placeholder:"请选择物品类型"},model:{value:e.orderForm.goodsTpye,callback:function(r){e.$set(e.orderForm,"goodsTpye",r)},expression:"orderForm.goodsTpye"}},[o("el-option",{attrs:{label:"请选择",value:"请选择",disabled:""}}),e._v(" "),e._l(e.goodsTpyeList,function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"物品大小 : ",prop:"goodsSize"}},[o("el-select",{attrs:{placeholder:"请选择物品大小"},model:{value:e.orderForm.goodsSize,callback:function(r){e.$set(e.orderForm,"goodsSize",r)},expression:"orderForm.goodsSize"}},[o("el-option",{attrs:{label:"请选择",value:"请选择",disabled:""}}),e._v(" "),e._l(e.goodsSizeList,function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"快递公司(可多选) : ",prop:"company"}},[o("el-select",{attrs:{multiple:"",placeholder:"请选择快递公司"},model:{value:e.orderForm.company,callback:function(r){e.$set(e.orderForm,"company",r)},expression:"orderForm.company"}},[o("el-option",{attrs:{label:"请选择",value:"请选择",disabled:""}}),e._v(" "),e._l(e.companyList,function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"取货码(可多个) : ",prop:"goodsCode"}},[o("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"","no-data-text":"添加方法: 回车或者选择文本",placeholder:"请输入取货码"},model:{value:e.orderForm.goodsCode,callback:function(r){e.$set(e.orderForm,"goodsCode",r)},expression:"orderForm.goodsCode"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"发布价格(1-20元) : ",prop:"Price"}},[o("el-input-number",{attrs:{precision:2,step:1,max:20,min:1},model:{value:e.orderForm.Price,callback:function(r){e.$set(e.orderForm,"Price",r)},expression:"orderForm.Price"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"快递数量 : ",prop:"goodsNumber"}},[o("el-input-number",{attrs:{step:1,max:10,min:1},model:{value:e.orderForm.goodsNumber,callback:function(r){e.$set(e.orderForm,"goodsNumber",r)},expression:"orderForm.goodsNumber"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"margin-left":"0.5rem"},attrs:{label:"备注 : ",prop:"remarks"}},[o("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容...",resize:"none"},model:{value:e.orderForm.remarks,callback:function(r){e.$set(e.orderForm,"remarks",r)},expression:"orderForm.remarks"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(r){e.submitForm("newOrder")}}},[e._v("发布")]),e._v(" "),o("el-button",{on:{click:function(r){e.resetForm("newOrder")}}},[e._v("重置")])],1)],1)],1)],1)},staticRenderFns:[]};var i=o("VU/8")(n,l,!1,function(e){o("o1P7")},null,null);r.default=i.exports},o1P7:function(e,r){}});